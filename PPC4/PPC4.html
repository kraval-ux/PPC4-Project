<html>
    <!--//https://jqueryui.com/demos/-->
    <head>
        <title>PPC - Pedagogical Pattern Composer v21 Kraval</title>
        <link rel="stylesheet" href="js/jquery-ui-1.12.1/jquery-ui.min.css"  type="text/css"/>
        <link rel="stylesheet" href="./css/style.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="./css/textileToolbar.css">
		
		<!--Accordion  -->

		
		<!--Dialog-->
		<link rel="stylesheet" href="./css/jquery.dialog.css">
		<script src="./js/jquery.js"></script>
		<script src="./js/jquery.dialog.js"></script>
		
	
 
        <script src="./js/jquery-ui-1.12.1/external/jquery/jquery.js"></script>
        <script src="./js/jquery-ui-1.12.1/jquery-ui.min.js" type="text/javascript"></script>
        <script src="./js/js.js" type="text/javascript"></script>
        <script type="text/javascript" language="javascript" src="./js/hoverIntent.js"></script>
        <script type="text/javascript" language="javascript" src="./js/autosize.js"></script>
    <!--script type="text/javascript" language="javascript" src="./js/jquery.dropdown.js"></script>
    <script type="text/javascript" language="javascript" src="./js/jquery.dropdownPlain.js"></script>
    <script src="./js/jquery.textileToolbar.js?v=201807181541"></script--> 
		
		 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		

<script src="./js/jquery.min.js"></script>
<script src="./js/jquery-resizable.js"></script>
		<script type="text/javascript">
   window.onbeforeunload = function() { return "Your work will be lost."; };
</script>

		
		<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-93978878-1', 'auto');
  ga('send', 'pageview');
			
</script>
		<script>
					// dialogue
			
			// end of dialogue
			
			</script>

		
    </head>
    <body>

<div style="background-image: url(images/motto.jpg); height:35px;width:100%;">
	<table width="100%" border="0">
    <tbody>
        <tr>
          <td><img src="images/PPCLogo3.gif" width="111" height="30" alt=""/></td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td></td>
          <td><a href="https://youtu.be/pHF0QRXyUmY" target="_blank">Video Guide</a></td>
          <td></td>
          <td>&nbsp;</td>
          <td width="200"><input type="file" id="inputfile"></td>
          <td width="100"><button id="SaveAs" style="font-size: 12; width: 50pt; height:20" title="Save as...">Save as...</button></td>
          <td width="250" style="font-size: 10px; font-weight: bold; font-style: normal; text-align: right;"><span style="font-weight: normal">Designed and Developed by</span> <span style="font-size: 12px"><br>
          Dejan Ljubojevic</span></td>
        </tr>
    </tbody>
    </table>
	
		</div>
     <hr>
		<hr>
		
   <button class="accordion">+ Learning Outcomes </button>
<div class="panel">
	
	
	<table width="100%" border="0">
      	<tbody>
            <tr>
              <td width="15%" style="font-size: small"> Students should be able to ...</td>
              <td width="84%"><button id="addLO" style="font-size: 15; width: 40pt; height:35" ><img alt="Add LO button ..." src="images/add_icon.png"/></button> Add Learning Outcomes </td>
              <td width="1%" style="font-size: small">  </td>
        </tr>
      </tbody>
        </table>
	
		</div>

<button class="accordion">+ Properties</button>
<div class="panel">
  <p>Properties to come</p>
	
		<button id="opener">open the dialog</button>
</div>
		
		 <hr>
		<hr>
<div style="height: 40px">
		<table width="100%" border="0" cellspacing="0" cellpadding="0">
      	<tbody>
            <tr>
              <td width="1%"> </td>
              <td width="20%"><button id="addSegment" style="font-size: 15; width: 100pt; height:30" class="btn">Add Segment +</button></td>
              <td width="30%"><font size="3">Total time:</font><textarea disabled id = "totalTime" style="vertical-align: middle; max-lines: 1; columns: 3; height: 25px; max-width: 40; resize: none; font-size: 13pt;"></textarea>
              minutes</td>
				<td width="45%">
				<table style="font-size: 12" id="tableGraph">
					<td width="15%" style="background-color: #f6f977"><a>RWL</a></td>
					<td width="15%" style="background-color: #b1f577"><a>INV</a></td>
					<td width="15%" style="background-color: #a1b12a"><a>DIS</a></td>
					<td width="15%" style="background-color: #c5bf79"><a>PRA</a></td>
					<td width="15%" style="background-color: #9fb2fa"><a>COL</a></td>
					<td width="15%" style="background-color: #bcb4fa"><a>PRO</a></td>
					</table>
				</td>
        </tr>
      </tbody>
        </table>
		
		</div>
		
		
		

<div id="SContainer" class="flex-container" style="height: 80%">
    
</div>
		

<script>
	
	
	//var segmentDuration=19;
	
	// accordion 
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
	// end of acordion
	
	
	// testing file open
	
	/*
	function dl(obj){
   window.location = obj.src;
}
*/

	//

var PatternNode = new Array();
	//PatternNode[0]='kiwi';
	//console.log(PatternNode[0]);
	
	//////////////////// ******************************************* opener 
	
	
	
	
	
	
	// add LO routine 
	
	$("#addLO").click(function()
    {
		//console.log("LO button");
		
		/////
		
		var LOPar = $(event.target).parent().parent();
	
	console.log("LOPar is ... "+LOPar.tagName);
		console.log("LOPar is ... "+LOPar.name);
		console.log("LOPar is ... "+LOPar.innerHTML);
        //var segment = $(event.target).parent().parent().parent().parent().parent();
	//console.log(par+" here " + par.id);
       // var childrenAll = $(LOPar).children();
        var containerB = document.createElement('div');
		var containerA = $("<div style='width:80%;'>");
        fetch('./LOpanel.html')
        .then(response => response.text())
        .then(data => {
        //h1.innerHTML = data; 
        containerA.append(data);
			containerB.innerHtml = data;
			//containerA+="</div>";
        });  
		 //$(par).children('.panel-top').append(containerB);
    //$(LOPar).append(containerA);
		
		LOPar.append(containerA);
		//$("LOPanelDIV").append(containerA);
		
		//////
		
		
		
	});
	
	// end of LO

/// addLA routine ----------------------------------------------------------------
function addLA(event) {
	
	
	var LearningActivityResourcesArray = new Array();
	PatternNode[0].push(LearningActivityResourcesArray); 
	//var LearnigActivityNode = new Array;
        var par = $(event.target).parent().parent().parent().parent().parent().parent();// 4 added
	
	
        //var segment = $(event.target).parent().parent().parent().parent().parent();
	//console.log(par+" here " + par.id);
        //var childrenAll = $(par).children();
	    var containerB = document.createElement('div');
        var containerA = $("<div style='width:490px;'>");
        fetch('./activityFile.html')
        .then(response => response.text())
        .then(data => {
        //h1.innerHTML = data; 
			//window.alert("Hello" + $('containerA').text);
        containerA.append(data);
			containerB.innerHTML = data;
			//window.alert("Hello" + data);
        }); 
	//var a = containerA.innerHTML
	//window.alert("Hello" + $('containerA').text);
	//console.log(" here container>>> " + containerA.outerHTML);//innerHTML);
    $(par).children('.panel-top').append(containerB);
	recalculateTimes(10);

    }
	
	/// end of addLA routine ----------------------------------------------------------------
	
	
	function recalculateTimes(time)
	{
		var totTime = time;
		 $('textarea').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 if (i =='DurationAct'){
				 			//arrayDurationAct.push(this.value);
				 totTime+=parseInt(this.value, 10);
				 			//console.log("hura" + this.children[2].tagName);
						  }
            	console.log("sve u svemu" + totTime);
			 
        });
		document.getElementById("totalTime").value = totTime;
	}
	
	
	/// SaveAs routine 
	$("#SaveAs").click(function()
    {  
       
		
		//var selectDialogueLink = $('<a href="">Select files</a>');
		//var fileSelector = $('<input type="file">');

    	//fileSelector.click();
			//var somehing = $("imnput:file");
			//$('body').html(selectDialogueLink);
		//console.log("here it comes: "+ $("input:file"));
		var tempFiles;
		// creating input on-the-fly
        var myFileInput = $(document.createElement("input")); 
        myFileInput.attr("type", "file");
		
        // add onchange handler if you wish to get the file :)
        myFileInput.trigger("click"); // opening dialog
		tempFiles = this.files;
		console.log("here it comes: "+ tempFiles);
        return false; // avoiding navigation
		
		
		
		
    	/*
        // Get the data from each element on the form.
    	const name = "----";
        const age = "----";
        const email = "----";
        const country = "----";
        const msg = "----";
        
        // This variable stores all the data.
        let data = 
            '\r Name: ' + name.value + ' \r\n ' + 
            'Age: ' +age.value + ' \r\n ' + 
            'Email: ' + email.value + ' \r\n ' + 
            'Country: ' + country.value + ' \r\n ' + 
            'Message: ' + msg.value;
		
		
		const textToBLOB = new Blob([data], { type: 'text/plain' });
        const sFileName = 'formData.txt';	   // The file to save the data.

        let newLink = document.createElement("a");
        newLink.download = sFileName;

        if (window.webkitURL != null) {
            newLink.href = window.webkitURL.createObjectURL(textToBLOB);
        }
        else {
            newLink.href = window.URL.createObjectURL(textToBLOB);
            newLink.style.display = "none";
            document.body.appendChild(newLink);
        }

        newLink.click(); 
		
		// creating input on-the-fly
        var output = $(document.createElement("input")); 
        output.attr("type", "file");
        // add onchange handler if you wish to get the file :)
        output.trigger("click"); // opening dialog
        return false; // avoiding navigation
        */  
		
		
	/*
	
		var arrayTemp = new Array();
		var arrayTitles = new Array();
		var arrayDuration = new Array();
		var arrayDates = new Array();
		var arrayTextActivity = new Array();
		var arrayTypeActivity = new Array();
		var arraycalendarDate = new Array();
		var arrayDurationAct = new Array();
		var arrayLOText = new Array();
		var arrayLOTypeSelect = new Array();
		var groupSizeTemp = new Array();
		var SynchButtonTemp = new Array();
		var introText = "";
		var totalTimeTemp=0;
		var containsSynchAct=false;
		
		
		var segmentElement = event.target.parentElement.parentElement.parentElement.parentElement.parentElement;//.parentElement;
		
		/// to determine position in the parent array to derive the resources attached to the activities within the segment
		var ParSegment = segmentElement.parentElement; // this is id = 'Scontainer' this is the Design Space   
		var positionIndex = Array.from(ParSegment.children).indexOf(segmentElement); /// this is order number of the segment in the sequence
		//console.log("Title" + segmentElementdocument.getElementById('segmentTitle').value); //.getElementById('segmentTitle').value);
		
	
		
		//var c = $(segmentElement).children('.panel-top');
		//var c = $(segmentElement).children('.panel-top')[0].children.length;
		//var d = segmentElement.getElementById("DisplayLA").firstChild.innerHTML;
		
		//var c = segmentElement.children[7].tagName; // 7 is a DIV segment
		//var c = segmentElement.children.getById('LA').tagName;
		//var c = segmentElement.segmentTitle.value; //getElementsByTagName('div');
		 
		
		
		
		 $('div').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 if (i =='LA'){
				 			arrayTemp.push(this);
				 			//console.log("hura" + this.children[2].tagName);
						  }
		
        });
		
		 $('select').each(function () {
            var i = $(this).attr('id');
			 if (i =='activitySelect'){
				 			 //arrayTypeActivity.push(this.value);
				 if (this.value=="ReadWatchListen")
				 {arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/rwl.jpg");}
				 else
					 if (this.value=="Investigate"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/investigate.jpg");}
				 else
					 if (this.value=="Discuss"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/discuss.jpg");}
				 else
					 if (this.value=="Practice"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/practice.jpg");}
				 else
					 if (this.value=="Collaborate"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/collaborate.jpg");}
				 else
					 if (this.value=="Produce"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/produce.jpg");}
			
					 
				 			//console.log("hura" + this.children[2].tagName);
						  }
			 if (i == 'LOTypeSelect')
			 		{
					arrayLOTypeSelect.push(this.value);
				 	}
            	
        });
		
		 $('textarea').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 
			 if (i =='groupSize')
			 {	
				 groupSizeTemp.push(this.value);
				 //console.log("activity hura >>> " + this.value)
			 }
			 if (i =='totalTime')
			 {	
				 totalTimeTemp = this.value;
				 //console.log("activity hura >>> " + this.value)
			 }
			 
			 if (i =='ActText')
			 {	
				 arrayTextActivity.push(this.value);
				 //console.log("activity hura >>> " + this.value)
			 }
			 if (i=='introText')
				 {introText=this.value;}
            	//console.log(i);
			 
			 if (i =='DurationAct'){
				 			arrayDurationAct.push(this.value);
				 			//console.log("hura" + this.children[2].tagName);
						  }
			 	 if (i=='LOText')
				 {
					 
					 arrayLOText.push(this.value);
					//console.log("hurikan");
				 }
            	console.log(i);
        });
	
	
		
		
		 $('input').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 var j = $(this).attr('name');
			 if (i =='calendarDate'){
				 			arraycalendarDate.push(this.value);
				 			//console.log("hura" + this.children[2].tagName);
						  }
			if (j =='typeRes'){
				 			//arraycalendarDate.push(this.value);
				 			//console.log("hura &&&&&&&&&&&&&&&&&&&&&&&&" + this.value);
						  }
			  if (i =='SynchButton')
			 {	
				 SynchButtonTemp.push(this.value);
				 if (this.value=="Synchronous") {containsSynchAct=true;}
		
		
				 //console.log("synchButton hura >>>>>>>>>>>>>> " + this.value)
			 }
        });
		
		
	
		
		//var LAs = $('#segmentElement').children(".LA");//.attr('id');//segmentElement.querySelectorAll(':scope > .LA');
		//var LAs = Array.from(segmentElement.children).filter(function (child) {return child.classList.contains('LA');});


		
		//console.log("segment child tagname>>>> "+ segmentElement.children[7].children[2].children[0].getAttribute("class"));
		var stringHTML = "<table style='width: 100%; border=0'><tbody><tr><td style='width:50%'><span class='ActivityTitle' style='font-size: large; color: #000000; font-family: verdana, geneva;'><strong>"+arraycalendarDate[0]+"</strong></span></td><td>";
			if (containsSynchAct){
			stringHTML+="<span class='ActivityTitle' style='font-size: large; color: #ff0000; font-family: verdana, geneva;'><strong> note - contains synchronous activity </strong></span>";
			}
			 
		stringHTML+="</td></tr><tr><td><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>Estimated completion time for this activities-set is <strong>"+ totalTimeTemp +" minutes </strong><br/><br />The activities-set addresses the following Learning Outcomes</span><br /><ul>";
		for (j=0;j<arrayLOText.length;j++)
			{
			stringHTML+="<li><strong><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'><b>"+arrayLOText[j]+"</b><span style='font-size: small'> - ("+arrayLOTypeSelect[j]+")</span></strong></li>";
			}
		
		stringHTML+="</ul></td><td><br /><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>";
		
		stringHTML+= introText+"</span></td></tr></tbody></table>"; // 
		
		for (oo=0;oo<arrayTemp.length;oo++)
			{
				var orderNo=oo+1
			stringHTML+="<table style='width: 100%;'><tbody><tr><td width='50%'><img src='"+arrayTypeActivity[oo]+"' alt='production icon' width='100%' height='100%' /></td><td style='text-align: right;'><span style='font-size: large; color: #000000; font-family: verdana, geneva;'><strong>"+orderNo+"</strong></span></td></tr><tr><td width='55%'><p>&nbsp;</p><p><br /><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>";
		
			stringHTML+= arrayTextActivity[oo]+"</p><p><span style='font-size: small; color: #b7b7b7; font-family: verdana, geneva;'>";
				
				if (groupSizeTemp[oo]=="1") 
				{stringHTML+=" (work on your own for approximately ";}
				else if (groupSizeTemp[oo]=="2")
				{stringHTML+=SynchButtonTemp[oo]+" work in pairs for approximately ";}
				else
				{stringHTML+=SynchButtonTemp[oo] + " work in a group for approximately ";}
				
				
				
			stringHTML+= arrayDurationAct[oo]+" minutes)</span></p></td><td style='text-align: left;'><br /><span style='font-size: small; color: #000000; font-family: verdana, geneva;'> Resources/tools for activity "+ orderNo +":</span><br /><ul>";
				
				//stringHTML+=PatternNode[0][oo][0][2] +" "+PatternNode[0][oo][0][1] +" "+PatternNode[0][oo][0][0];
				for (i=0; i<PatternNode[0][oo].length; i++)
					{
				
				if (PatternNode[0][oo][i][2]=="Video(embed)")
					{
						stringHTML+= "<li><div><iframe src='"+PatternNode[0][oo][i][1]+"' width='320' height='300' allowfullscreen='allowfullscreen'></iframe></div></li>";
					}
				else
					{
						stringHTML+= "<li><span style='font-size: small; color: #000000; font-family: verdana, geneva;'><a href='"+PatternNode[0][oo][i][1]+"' target='_blank' rel='noopener'>"+PatternNode[0][oo][i][0]+" ("+PatternNode[0][oo][i][2]+")"+"</a></span></li>";
						
					}
					}
				stringHTML+="</ul></td></tr></tbody></table>";
			}
		stringHTML+="<table style='font-family: Lucida Grande, Arial, sans-serif; font-size: 14px; width: 100%; height: 5px;' border='0'><tbody style='font-size: 14px;'><tr style='font-size: 14px;'><td width='33%'>&lt;previous</td><td style='text-align: center;' width='33%'><span style='font-size: 12pt;'>home</span></td><td style='text-align: right;' width='33%'><span style='font-size: 12pt;'> next></span></td></tr></tbody></table>"
		
		//var tempElements = document.getElementsByClassName('panel-top resizable');
		//var testDivs = Array.prototype.filter.call(segmentElement, function(segmentElement){
  //return tempElements.id === 'LA';});
		
	
		
		//panel-top resizable
		
		
		 
		//stringHTML += arrayTextActivity[0]+" je tekst u aktivnosti </html>";
	
		//console.log("segment element ima dece ... "+ segmentElement.children.length + " iiii "+ c + "DDDDD > "+ d);
		
		console.log("segment je redni broj ... "+ positionIndex + " i duljina PatternNode je " + ParSegment.children.length);
		 console.log(arrayTypeActivity[0]+"  je tip aktivnosti");
		
		
		//console.log(">>>> "+ stringHTML);
		
		const el = document.createElement('textarea');
  		el.value = stringHTML;
  		document.body.appendChild(el);
  		el.select();
  		document.execCommand('copy');
  		document.body.removeChild(el);
		alert("HTML code has been placed on the clipboard!");
	
	
	*/
       
	})
	
	/// end of SaveAs routine 
	
	
	
   /// addSegment routine ----------------------------------------------------------------
$("#addSegment").click(function()
    {   
	var SegmentNode = new Array();
	PatternNode.push(SegmentNode); 
        //console.log("duljina PatternNode je " + PatternNode.length);
//var LearnigActivitynNode = new Array;

        //var title = "Constructing HTML Elements";
//var containerB = document.createElement('div');
	
var containerA = $("<div style='width:500px;'>");
                                            fetch('./segmentFile.html')
                                            .then(response => response.text())
                                            .then(data => {
                                            //h1.innerHTML = data; 
                                            containerA.append(data);
											//containerB.innerHTML = data;
												//containerB.append(data);
												
                                            });     
$("#SContainer").append(containerA);  
                // tutorial: https://www.youtube.com/watch?v=peWrZD0meTs&t=107s
    });     
	/// end of  addSegment routine --------------------------------------------------------
	
	
	// remove Segment from Design
	function closeSegment(event)
	{
		var LADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;//.parentElement;
		//var ParLADiv = //event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;//.parentElement;
		var ParLADiv = LADiv.parentElement;
		
		var numchil = LADiv.children.length;
		for (i=0;i<numchil;i++)
			{LADiv.children[i].removeChild;}
		var positionIndex = Array.from(ParLADiv.children).indexOf(LADiv);
		
		PatternNode.splice(positionIndex,1);
		console.log("obrisan je redni broj ... "+ positionIndex + " i duljina PatternNode je " + PatternNode.length);
		//$("#SContainer").remove(LADiv);
		ParLADiv.removeChild(LADiv);
		if (PatternNode.length==0){console.log("ko je LAdiv ... "+ LADiv.id);("#SContainer").removeAllRanges;}
		
	}
	// end of remove Segment from Design
	

	
	function activityType(event) {
		var something = event.target.parentElement.parentElement.parentElement.parentElement.id;
        console.log("pressed "+ something);
    }
	
	
//resize as you type in LAText	
	function resizeTextArea(event)
{
    
    FitToContent( event.target, 500, 150);
    var tempDiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
    var hoLA = parseInt(event.target.style.height) + 30;
    tempDiv.style.height = hoLA+"px";
    //console.log("stigli "+hoLA);

}
	//end of resize as type in LAText
	
	
	
	
	
	// remove LO item from LO list - Learning Outcome 
	
	function closeLOBox(event)
	{
		var LODiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
		var LOname = LODiv.id.text; 
		var LOPar = LODiv.parentElement;
		//var ParLADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement;
		//var selection = event.target.value;
		LOPar.remove(LODiv);
		console.log("the box "+  LODiv + " name - "+LOname);
	}
	
	//end of remove LA box form Segment 
	
	
	
	// remove LA box from segment Learning Activity
	
	function closeActivityBox(event)
	{
		var LADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement;
		var ParLADiv =  LADiv.parentElement; //event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
		//var selection = event.target.value;
		
		ParLADiv.remove(LADiv);
		//LADiv.delete;
		
		//console.log("pressed "+ selection + " and " + LADiv);
	}
	
	//end of remove LA box form Segment 
	
	
	/// dropdown LO type 
	function typeLOChange(event)
	{
		var LODiv = event.target.parentElement.parentElement.parentElement;//.parentElement.parentElement;
		var selection = event.target.value;
		console.log("pressed "+ selection + " and " + LODiv);
	

      switch(selection) {
  case "Knowledge":
  LODiv.style.backgroundColor = "#F8F8F8";
    break;
  case "Comprehension":
  LODiv.style.backgroundColor = "#E8E8E8";
    break;
  case "Application":
  LODiv.style.backgroundColor = "#DCDCDC";
    break;
  case "Analysis":
  LODiv.style.backgroundColor = "#C8C8C8";
    break;
  case "Evaluation":
  LODiv.style.backgroundColor = "#BEBEBE";
    break;
    case "Synthesis":
    LODiv.style.backgroundColor = "#A9A9A9";
    break;
  default:
    LODiv.style.backgroundColor = "#808080";
}
   
    //console.log(str);

	}
	
	
	/// drop down end 
	
	
	
	
	
	
	/// dropdown LA type 
	function typeLAChange(event)
	{
		var LADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement;
		var selection = event.target.value;
		console.log("pressed "+ selection + " and " + LADiv);
	

      switch(selection) {
  case "Read Watch Listen":
  LADiv.style.backgroundColor = "#f6f977";
    break;
  case "Investigate":
  LADiv.style.backgroundColor = "#b1f577";
    break;
  case "Discuss":
  LADiv.style.backgroundColor = "#a1b12a";
    break;
  case "Practice":
  LADiv.style.backgroundColor = "#c5bf79";
    break;
  case "Collaborate":
  LADiv.style.backgroundColor = "#9fb2fa";
    break;
    case "Produce":
    LADiv.style.backgroundColor = "#bcb4fa";
    break;
  default:
    LADiv.style.backgroundColor = "#f6f977";
}
   
    //console.log(str);

	}
	
	
	/// drop down end 
	
	
	////// Attach Resaourcedialogue block ////////////////
	
	
	
// toggle
	
	
	function toggleSynch(event)
	{
	
		if (event.target.value=="Asynchronous") {event.target.value = "Synchronous";}
		else if (event.target.value=="Synchronous") {event.target.value = "Asynchronous";}
		
	}
	
	function toggleTeachPresent(event)
	{
		if ($("event.target").attr("src")=="images/teacherOff.gif") 
		{$("event.target").attr("src","images/teacher.gif");}
		//if (event.target.attr(Image).source=="images/teacherOff.gif") {event.target.attr(Image).source = "images/teacher.gif";}
		//else if (event.target.value=="images/teacher.gif") {event.target.value = "images/teacherOff.gif";}
	}
	//img src="images/teacherOff.gif
	

	
	/////// export segment 
	
	function exportSegment(event)
	{
		
		var arrayTemp = new Array();
		var arrayTitles = new Array();
		var arrayDuration = new Array();
		var arrayDates = new Array();
		var arrayTextActivity = new Array();
		var arrayTypeActivity = new Array();
		var arraycalendarDate = new Array();
		var arrayDurationAct = new Array();
		var arrayLOText = new Array();
		var arrayLOTypeSelect = new Array();
		var groupSizeTemp = new Array();
		var SynchButtonTemp = new Array();
		var introText = "";
		var totalTimeTemp=0;
		var containsSynchAct=false;
		
		
		var segmentElement = event.target.parentElement.parentElement.parentElement.parentElement.parentElement;//.parentElement;
		
		/// to determine position in the parent array to derive the resources attached to the activities within the segment
		var ParSegment = segmentElement.parentElement; // this is id = 'Scontainer' this is the Design Space   
		var positionIndex = Array.from(ParSegment.children).indexOf(segmentElement); /// this is order number of the segment in the sequence
		//console.log("Title" + segmentElementdocument.getElementById('segmentTitle').value); //.getElementById('segmentTitle').value);
		
	
		
		//var c = $(segmentElement).children('.panel-top');
		//var c = $(segmentElement).children('.panel-top')[0].children.length;
		//var d = segmentElement.getElementById("DisplayLA").firstChild.innerHTML;
		
		//var c = segmentElement.children[7].tagName; // 7 is a DIV segment
		//var c = segmentElement.children.getById('LA').tagName;
		//var c = segmentElement.segmentTitle.value; //getElementsByTagName('div');
		 
		
		
		
		 $('div').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 if (i =='LA'){
				 			arrayTemp.push(this);
				 			//console.log("hura" + this.children[2].tagName);
						  }
		
        });
		
		 $('select').each(function () {
            var i = $(this).attr('id');
			 if (i =='activitySelect'){
				 			 //arrayTypeActivity.push(this.value);
				 if (this.value=="ReadWatchListen")
				 {arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/rwl.jpg");}
				 else
					 if (this.value=="Investigate"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/investigate.jpg");}
				 else
					 if (this.value=="Discuss"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/discuss.jpg");}
				 else
					 if (this.value=="Practice"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/practice.jpg");}
				 else
					 if (this.value=="Collaborate"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/collaborate.jpg");}
				 else
					 if (this.value=="Produce"){arrayTypeActivity.push("http://kunet.kingston.ac.uk/~ku52748/PPC/images/produce.jpg");}
			
					 
				 			//console.log("hura" + this.children[2].tagName);
						  }
			 if (i == 'LOTypeSelect')
			 		{
					arrayLOTypeSelect.push(this.value);
				 	}
            	
        });
		
		 $('textarea').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 
			 if (i =='groupSize')
			 {	
				 groupSizeTemp.push(this.value);
				 //console.log("activity hura >>> " + this.value)
			 }
			 if (i =='totalTime')
			 {	
				 totalTimeTemp = this.value;
				 //console.log("activity hura >>> " + this.value)
			 }
			 
			 if (i =='ActText')
			 {	
				 arrayTextActivity.push(this.value);
				 //console.log("activity hura >>> " + this.value)
			 }
			 if (i=='introText')
				 {introText=this.value;}
            	//console.log(i);
			 
			 if (i =='DurationAct'){
				 			arrayDurationAct.push(this.value);
				 			//console.log("hura" + this.children[2].tagName);
						  }
			 	 if (i=='LOText')
				 {
					 
					 arrayLOText.push(this.value);
					//console.log("hurikan");
				 }
            	console.log(i);
        });
	
	
		
		
		 $('input').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 var j = $(this).attr('name');
			 if (i =='calendarDate'){
				 			arraycalendarDate.push(this.value);
				 			//console.log("hura" + this.children[2].tagName);
						  }
			if (j =='typeRes'){
				 			//arraycalendarDate.push(this.value);
				 			//console.log("hura &&&&&&&&&&&&&&&&&&&&&&&&" + this.value);
						  }
			  if (i =='SynchButton')
			 {	
				 SynchButtonTemp.push(this.value);
				 if (this.value=="Synchronous") {containsSynchAct=true;}
		
		
				 //console.log("synchButton hura >>>>>>>>>>>>>> " + this.value)
			 }
        });
		/*
		 $('input').each(function () {
			 //$(segmentElement.children).each(function () {
            var i = $(this).attr('id');
			 if (i =='daterange'){console.log("date hura" +  $(this).attr('value'))}
            	console.log(i);
        });*/
		
	
		
		//var LAs = $('#segmentElement').children(".LA");//.attr('id');//segmentElement.querySelectorAll(':scope > .LA');
		//var LAs = Array.from(segmentElement.children).filter(function (child) {return child.classList.contains('LA');});


		
		//console.log("segment child tagname>>>> "+ segmentElement.children[7].children[2].children[0].getAttribute("class"));
		var stringHTML = "<table style='width: 100%; border=0'><tbody><tr><td style='width:50%'><span class='ActivityTitle' style='font-size: large; color: #000000; font-family: verdana, geneva;'><strong>"+arraycalendarDate[0]+"</strong></span></td><td>";
			if (containsSynchAct){
			stringHTML+="<span class='ActivityTitle' style='font-size: large; color: #ff0000; font-family: verdana, geneva;'><strong> note - contains synchronous activity </strong></span>";
			}
			 
		stringHTML+="</td></tr><tr><td><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>Estimated completion time for this activities-set is <strong>"+ totalTimeTemp +" minutes </strong><br/><br />The activities-set addresses the following Learning Outcomes</span><br /><ul>";
		for (j=0;j<arrayLOText.length;j++)
			{
			stringHTML+="<li><strong><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'><b>"+arrayLOText[j]+"</b><span style='font-size: small'> - ("+arrayLOTypeSelect[j]+")</span></strong></li>";
			}
		
		stringHTML+="</ul></td><td><br /><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>";
		
		stringHTML+= introText+"</span></td></tr></tbody></table>"; // 
		
		for (oo=0;oo<arrayTemp.length;oo++)
			{
				var orderNo=oo+1
			stringHTML+="<table style='width: 100%;'><tbody><tr><td width='50%'><img src='"+arrayTypeActivity[oo]+"' alt='production icon' width='100%' height='100%' /></td><td style='text-align: right;'><span style='font-size: large; color: #000000; font-family: verdana, geneva;'><strong>"+orderNo+"</strong></span></td></tr><tr><td width='55%'><p>&nbsp;</p><p><br /><span style='font-size: medium; color: #000000; font-family: verdana, geneva;'>";
		
			stringHTML+= arrayTextActivity[oo]+"</p><p><span style='font-size: small; color: #b7b7b7; font-family: verdana, geneva;'>";
				
				if (groupSizeTemp[oo]=="1") 
				{stringHTML+=" (work on your own for approximately ";}
				else if (groupSizeTemp[oo]=="2")
				{stringHTML+=SynchButtonTemp[oo]+" work in pairs for approximately ";}
				else
				{stringHTML+=SynchButtonTemp[oo] + " work in a group for approximately ";}
				
				
				
			stringHTML+= arrayDurationAct[oo]+" minutes)</span></p></td><td style='text-align: left;'><br /><span style='font-size: small; color: #000000; font-family: verdana, geneva;'> Resources/tools for activity "+ orderNo +":</span><br /><ul>";
				
				//stringHTML+=PatternNode[0][oo][0][2] +" "+PatternNode[0][oo][0][1] +" "+PatternNode[0][oo][0][0];
				for (i=0; i<PatternNode[0][oo].length; i++)
					{
				
				if (PatternNode[0][oo][i][2]=="Video(embed)")
					{
						stringHTML+= "<li><div><iframe src='"+PatternNode[0][oo][i][1]+"' width='320' height='300' allowfullscreen='allowfullscreen'></iframe></div></li>";
					}
				else
					{
						stringHTML+= "<li><span style='font-size: small; color: #000000; font-family: verdana, geneva;'><a href='"+PatternNode[0][oo][i][1]+"' target='_blank' rel='noopener'>"+PatternNode[0][oo][i][0]+" ("+PatternNode[0][oo][i][2]+")"+"</a></span></li>";
						
					}
					}
				stringHTML+="</ul></td></tr></tbody></table>";
			}
		stringHTML+="<table style='font-family: Lucida Grande, Arial, sans-serif; font-size: 14px; width: 100%; height: 5px;' border='0'><tbody style='font-size: 14px;'><tr style='font-size: 14px;'><td width='33%'>&lt;previous</td><td style='text-align: center;' width='33%'><span style='font-size: 12pt;'>home</span></td><td style='text-align: right;' width='33%'><span style='font-size: 12pt;'> next></span></td></tr></tbody></table>"
		
		//var tempElements = document.getElementsByClassName('panel-top resizable');
		//var testDivs = Array.prototype.filter.call(segmentElement, function(segmentElement){
  //return tempElements.id === 'LA';});
		
	
		
		//panel-top resizable
		
		
		 
		//stringHTML += arrayTextActivity[0]+" je tekst u aktivnosti </html>";
	
		//console.log("segment element ima dece ... "+ segmentElement.children.length + " iiii "+ c + "DDDDD > "+ d);
		
		console.log("segment je redni broj ... "+ positionIndex + " i duljina PatternNode je " + ParSegment.children.length);
		 console.log(arrayTypeActivity[0]+"  je tip aktivnosti");
		
		
		//console.log(">>>> "+ stringHTML);
		
		const el = document.createElement('textarea');
  		el.value = stringHTML;
  		document.body.appendChild(el);
  		el.select();
  		document.execCommand('copy');
  		document.body.removeChild(el);
		alert("HTML code has been placed on the clipboard!");
		
	}
	
	
	////// end of export segment 
	
	
	$("#opener").click(function(event)
		{
		
		
		//var containerA = $("<div style='width:80%;'>");
        fetch('./resourceManager.html')
        .then(response => response.text())
        .then(data => {
        //h1.innerHTML = data; 
        //containerA.append(data);
			//containerB.innerHtml = data;
			//containerB.append(containerA);
			//console.log(data);
			//containerA+="</div>";
			jAlert(data);
        });  
		//window.alert('<button>Click me :) </button>');
		
		
		});
	
	function attachResources(event)
	{
		var LADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
		var ParLADiv = LADiv.parentElement;
		
		var TopParLADiv = ParLADiv.parentElement;
		var positionIndex = Array.from(TopParLADiv.children).indexOf(ParLADiv);
		GlobalActivityPositionIndex = positionIndex; 
		//var containerA = $("<div style='width:80%;'>");
        fetch('./resourceManager.html')
        .then(response => response.text())
        .then(data => {
        //h1.innerHTML = data; 
        //containerA.append(data);
			//containerB.innerHtml = data;
			//containerB.append(containerA);
			//console.log(data);
			//containerA+="</div>";
			jAlert(data);
        });  
		//window.alert('<button>Click me :) </button>');
		$('#listResources').text("");
		if (PatternNode[0][positionIndex].length>0) //for each activity if it contains resources-array 
			{
				
				//$('#listResources').text("");
				
				//PatternNode[0][oo][i][1]
				
				for (j=0;j<PatternNode[0][GlobalActivityPositionIndex].length;j++)
					{
						//console.log("ima nešto da se pokaže " + PatternNode[0][GlobalActivityPositionIndex].length);
						//console.log("resource "+j+" je "+PatternNode[0][GlobalActivityPositionIndex][j][0]);
						$('#listResources').append(PatternNode[0][GlobalActivityPositionIndex][j][0]+"\n");
						//document.getElementById('listResources').value+=PatternNode[0][GlobalActivityPositionIndex][j][0]+"\n";
					}
					
			}
		
	}
	
	
	
	
		///// this is to add resources to LA 
    function addResourceToLA(event) {
		
		var LADiv = event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
		var ParLADiv = LADiv.parentElement;
		//var position = ParLADiv.indexOf(LADiv);
		
		//var TopParLADiv = LADiv.parentElement.parentElement.parentElement.parentElement;
		var TopParLADiv = ParLADiv.parentElement;
		var positionIndex = Array.from(TopParLADiv.children).indexOf(ParLADiv);
		GlobalActivityPositionIndex = positionIndex; 
		
		
		
		console.log(LADiv+" je na rednom broju >>>>> "+positionIndex);// +" parent is "+ParLADiv);
		console.log(ParLADiv);
		console.log(TopParLADiv);
		
		//document.getElementById('light').children.namedItem("title");
		//console.log("value of title is ..."+document.getElementById('segmentTitle').value);
		
		//document.getElementById('listResources').value="";
		console.log(GlobalActivityPositionIndex + " je GlobalActivityPositionIndex");
		$('#listResources').text("");
		if (PatternNode[0][positionIndex].length>0) //for each activity if it contains resources-array 
			{
				
				//$('#listResources').text("");
				
				//PatternNode[0][oo][i][1]
				
				for (j=0;j<PatternNode[0][GlobalActivityPositionIndex].length;j++)
					{
						//console.log("ima nešto da se pokaže " + PatternNode[0][GlobalActivityPositionIndex].length);
						//console.log("resource "+j+" je "+PatternNode[0][GlobalActivityPositionIndex][j][0]);
						$('#listResources').append(PatternNode[0][GlobalActivityPositionIndex][j][0]+"\n");
						//document.getElementById('listResources').value+=PatternNode[0][GlobalActivityPositionIndex][j][0]+"\n";
					}
					
			}
		/*
		else
			{
				$('#listResources').text("");
			
			}*/
		
		document.getElementById('light').style.display='block';
		document.getElementById('fade').style.display='block'
    }
	
	///////////////////////
	
	var GlobalActivityPositionIndex;
	var GlobalSegmentPositionIndex;
	
	
	
	
	///////////////////////
	
	function attachToList()
	
	{
		var resourcesArray = new Array();
	
		
		
		//console.log("attach to list initialised ..."+document.getElementById('title').value);
		//console.log("url is ..."+document.getElementById('url').value);
		
	//TeachingLearningNode = new Array(); /// segment item
	//PatternNode.push(TeachingLearningNode); /// segment array
		//PatternNode[0][position].push
		
		const radioGroup = document.querySelectorAll('input[name="typeRes"]'); 
		
		let selectedValue;
            for (const rb of radioGroup) {
                if (rb.checked) {
                    selectedValue = rb.value;
					rb.checked = false; 
                    break;
                }
            }
		if($('#title').val() && $('#url').val() && selectedValue)
		{
		//document.getElementById('listResources').append(document.getElementById('title').value);
		
		$('#listResources').append($('#title').val()+"\n");
		resourcesArray[0]=$('#title').val();
		resourcesArray[1]=$('#url').val();
		resourcesArray[2]=selectedValue;
		
		
		PatternNode[0][GlobalActivityPositionIndex].push(resourcesArray);
		
		console.log("here is the attached ..."+PatternNode[0][GlobalActivityPositionIndex][0][2] +" "+PatternNode[0][GlobalActivityPositionIndex][0][1] +" "+PatternNode[0][GlobalActivityPositionIndex][0][0]);
		
		//document.getElementById('listResources').innerHTML+="<br/>";
		
		
		document.getElementById('title').value="";
		document.getElementById('url').value ="";
		
		$('radioGroup').attr('checked', false);
		}
		else
			{alert("To attach resource you need to enter its title, url, and its type");}
	}
	
	
	
	////// End of Attach Resaourcedialogue block //////////////// 
	
	
	function updateAttachments() /// this is a place holder should there be any need to handle 
	{
		//console.log("stigli");//here is the attached ..."+arrayToUpdate[2] +" "+arrayToUpdate[1] +" "+arrayToUpdate[0]);
	}
	
	
	//// Open file routine 
	document.querySelector("#inputfile").addEventListener("change",function(){
				
				
				var reader = new FileReader();
    			reader.onload = function(){
      			//var text = reader.result;
					//var xmlData = $(reader.result);
      			console.log(reader.result.substring(0, reader.result.length));	
					//window.alert(xmlData.);//reader.result.substring(0, reader.result.length));
					parseFile(reader.result.substring(0, reader.result.length));
				};
				//reader.readAsDataURL(this.files[0]);
					reader.readAsText(this.files[0]);
		
				//var text = reader.result;
				//console.log(reader.result.substring(0,200));
				
	});
	
//// end of Open file routine 

	//this will parse XML file and output it to website
var parseFile = function(text) {
	var xmlDoc = $.parseXML(text),
		$xml = $(xmlDoc),
		$TLA = $xml.find("TeachingLearningActivity");
		$LO = $xml.find("LearningOutcome");
	
	$.each($LO, function() {
			
		$("#addLO").click();
		
		//$("#output").append("<li>" + $(this).text() + "</li >");
	});
	
	
	$.each($TLA, function() {
			
		$("#addSegment").click();
		
		//$("#output").append("<li>" + $(this).text() + "</li >");
	});

};
	
		</script>
	
		
		
		<div id="light" class="white_content"> 
			<div style="text-align:right">
			<button style="height: 20; width: 30; font-size: 12pt;" onClick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'; updateAttachments()">X</button>
				</div>
			<!--a href="javascript:void(0)" onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">Close</a-->
			<div>	

				
	<table width="100%" border="1" class = "group">
  <tbody>
    <tr>
		 <td width="15%">&nbsp;Title</td>
            <td><input size="60" id = "title" width="85%"  cols="20"></td>
          </tr>
          <tr>
            <td width="15%">&nbsp;URL</td>
            <td><input size="60" id = "url" width="100%" cols="20"></td>
          </tr>
			<tr>
            <td width="20%">&nbsp;</td>
            <td><button onclick="attachToList()">Attach</button></td>
          </tr>
			<tr>
            <td width="20%">&nbsp;Resources Attached</td>
            <td>
			<textarea id="listResources" style="resize: none" rows="10" cols="40" readonly></textarea></td>
		</tr>
	  </tbody>
	  </table>
	<table width ="100%">
		<tbody style="text-align: right">
	  <tr>
      <td><label><u>RWL</u></label></td>  
       <td> <label><input type="radio" name="typeRes" value="Presentation">Presentation</label></td>
       <td> <label><input type="radio" name="typeRes" value="Guide">Guide</label></td>
       <td> <label><input type="radio" name="typeRes" value="Video">Audio or Video</label></td>
		<td> <label><input type="radio" name="typeRes" value="Video(embed)" id="RWL_3" >Audio or Video (embed)</label></td></tr>
		 <tr>
			 <td><label><u>Discussion</u></label></td>
        <td><label><input type="radio" name="typeRes" value="Discussion Forum" id="Discuss_0">Discussion Forum</label></td>
        <td><label><input type="radio" name="typeRes" value="Web-Conferencing" id="Discuss_1">Web-Conferencing</label></td>
       <td> <label><input type="radio" name="typeRes" value="Dialogue Game" id="Discuss_2">Dialogue Game</label> </td></tr>
		<tr><td  padding="0">  <label><u>Investigation</u></label></td>
         <td><label><input type="radio" name="typeRes" value="Book / Chapter" id="Invest_0">Book / Chapter</label></td>
         <td><label><input type="radio" name="typeRes" value="Article" id="Invest_1">Article</label></td>
         <td><label><input type="radio" name="typeRes" value="Case Study" id="Invest_2">Case Study</label></td></tr>
		<tr><td  padding="0"><label><u>Practice</u></label></td>
       <td> <label><input type="radio" name="typeRes" value="Simulation" id="Prac_0">Simulation</label></td>
       <td> <label><input type="radio" name="typeRes" value="Modelling Tool" id="Prac_1">Modelling Tool</label></td>
        <td><label><input type="radio" name="typeRes" value="Other" id="Prac_2">Other</label></td></tr>
		<tr> <td  padding="0"> <label><u>Collaborate and Produce</u></label></td>
        <td><label><input type="radio" name="typeRes" value="Portfolio" id="ProdCollab_0">Portfolio</label></td>
        <td><label><input type="radio" name="typeRes" value="Simulation" id="ProdCollab_1">Simulation</label></td>
       <td> <label><input type="radio" name="typeRes" value="Wiki" id="ProdCollab_2">Wiki</label>  </td></tr>
  </tbody>
</table>
		  
	
				</div>
  </div>
  <div id="fade" class="black_overlay"></div>
		
		</body>
</html>